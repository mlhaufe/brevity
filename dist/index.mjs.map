{"version":3,"file":"index.mjs","mappings":"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","sources":["webpack://@mlhaufe/brevity/./node_modules/@final-hill/multi-key-map/dist/index.js","webpack://@mlhaufe/brevity/webpack/bootstrap","webpack://@mlhaufe/brevity/webpack/runtime/define property getters","webpack://@mlhaufe/brevity/webpack/runtime/hasOwnProperty shorthand","webpack://@mlhaufe/brevity/./src/Data.mjs","webpack://@mlhaufe/brevity/./src/Trait.mjs","webpack://@mlhaufe/brevity/./src/memoFix.mjs"],"sourcesContent":["!function(t,e){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=e():\"function\"==typeof define&&define.amd?define([],e):\"object\"==typeof exports?exports[\"multi-key-map\"]=e():t[\"multi-key-map\"]=e()}(this,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&\"object\"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,\"a\",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p=\"\",n(n.s=0)}([function(t,e,n){\"use strict\";\n/*!\n * @license\n * Copyright (C) 2020 Final Hill LLC\n * SPDX-License-Identifier: AGPL-3.0-only\n * @see <https://spdx.org/licenses/AGPL-3.0-only.html>\n */var r,o,s=this&&this.__classPrivateFieldSet||function(t,e,n){if(!e.has(t))throw new TypeError(\"attempted to set private field on non-instance\");return e.set(t,n),n},i=this&&this.__classPrivateFieldGet||function(t,e){if(!e.has(t))throw new TypeError(\"attempted to get private field on non-instance\");return e.get(t)};Object.defineProperty(e,\"__esModule\",{value:!0});const c=Symbol(\"noEntry\");class l{constructor(t){r.set(this,c),o.set(this,new Map),null==t||t.forEach(t=>this.set(...t))}*[(r=new WeakMap,o=new WeakMap,Symbol.iterator)](){const t=[];this.forEach((e,n)=>t.push([n,e]));for(const e of t)yield e}clear(){s(this,r,c),i(this,o).clear()}delete(...t){if(0==t.length)return i(this,r)!==c&&(s(this,r,c),!0);{const[e,n]=[t[0],t.slice(1)];if(i(this,o).has(e)){return i(this,o).get(e).delete(...n)}return!1}}*entries(){const t=[];this.forEach((e,n)=>t.push([n,e]));for(const e of t)yield e}forEach(t,e){this._forEach([],t,e)}get(...t){if(0==t.length)return i(this,r)===c?void 0:i(this,r);{const[e,n]=[t[0],t.slice(1)];if(i(this,o).has(e)){return i(this,o).get(e).get(...n)}return}}has(...t){if(0==t.length)return i(this,r)!==c;{const[e,n]=[t[0],t.slice(1)];return!!i(this,o).has(e)&&i(this,o).get(e).has(...n)}}*keys(){const t=[];this.forEach((e,n)=>t.push(n));for(const e of t)yield e}set(...t){const[e,n]=t.length<=1?[[],t[0]]:[t.slice(0,-1),t[t.length-1]];if(0==e.length)s(this,r,n);else{const[t,r]=[e[0],e.slice(1)];if(i(this,o).has(t)){i(this,o).get(t).set(...r,n)}else{const e=new l;e.set(...r,n),i(this,o).set(t,e)}}return this}get size(){let t=0;return this.forEach(()=>t++),t}toString(){return[...this].map(t=>{const[e,n]=t.length<=1?[[],t[0]]:[t.slice(0,-1),t[t.length-1]];return`[${e.join()}]:${n}`}).join(\";\")}*values(){const t=[];this.forEach(e=>t.push(e));for(const e of t)yield e}_forEach(t,e,n){i(this,r)!==c&&e.call(null!=n?n:this,i(this,r),t,this),i(this,o).forEach((r,o)=>{r._forEach([...t,o],e,n)})}}e.default=l}]).default}));\n//# sourceMappingURL=index.js.map","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// tests if a value is an object literal\r\nconst isObjectLiteral = obj => obj !== null && Object.getPrototypeOf(obj) === Object.prototype;\r\n// tests if a string is capitalized\r\nconst isCapitalized = str => typeof str === 'string' && str.match(/^[A-Z][A-Za-z0-9]*$/);\r\n// tests if a string is camelCase\r\nconst isCamelCase = str => typeof str === 'string' && str.match(/^[a-z][A-Za-z0-9]*$/);\r\n\r\nfunction def(variants) {\r\n    if (!isObjectLiteral(variants))\r\n        throw new TypeError('variants declaration must be an object literal');\r\n\r\n    for (const [name, params] of Object.entries(variants)) {\r\n        if (!isCapitalized(name))\r\n            throw new TypeError(`variant name must be capitalized: ${name}`);\r\n        if (!Array.isArray(params))\r\n            throw new TypeError(`variant properties must be an array: ${name}`);\r\n        if (!params.every(isCamelCase))\r\n            throw new TypeError(`variant properties must be camelCase strings: ${name}: ${params}`);\r\n        if (new Set(params).size !== params.length) {\r\n            throw new TypeError(`type parameters must be unique: ${name}: ${params}`);\r\n        }\r\n        // if the type has no parameters, it is a singleton\r\n        if (params.length === 0) {\r\n            variants[name] = Object.freeze(\r\n                Object.assign(Object.create(null), ({ [typeName]: name, [isSingleton]: true }))\r\n            )\r\n        } else {\r\n            // otherwise each type becomes a constructor\r\n            variants[name] = function (...args) {\r\n                const obj = Object.create(variants[name].prototype);\r\n\r\n                const objArg = args[0];\r\n                if (args.length === 1 && isObjectLiteral(objArg)) {\r\n                    if (Object.keys(objArg).length > params.length)\r\n                        throw new TypeError(`too many parameters. expected: ${name}: ${params}, got: ${name}: ${Object.keys(objArg)}`);\r\n                    for (const param of params) {\r\n                        if (!(param in objArg))\r\n                            throw new TypeError(`missing parameter: ${param}`);\r\n                        if (typeof objArg[param] === 'function')\r\n                            Object.defineProperty(obj, param, { get: objArg[param], enumerable: true });\r\n                        else\r\n                            obj[param] = objArg[param];\r\n                    }\r\n                } else if (args.length === params.length) {\r\n                    args.forEach((arg, i) => {\r\n                        if (typeof arg === 'function')\r\n                            Object.defineProperty(obj, params[i], { get: arg, enumerable: true });\r\n                        else\r\n                            obj[params[i]] = arg;\r\n                    })\r\n                } else {\r\n                    throw new TypeError(`wrong number of parameters: ${name}: ${params}`);\r\n                }\r\n\r\n                return Object.seal(obj);\r\n            }\r\n            variants[name].prototype = Object.freeze({ [typeName]: name, [isSingleton]: false });\r\n        }\r\n    }\r\n    // each type is tagged with a symbol\r\n    variants[isData] = true;\r\n    // the type declaration is immutable\r\n    return Object.freeze(variants);\r\n}\r\n\r\nexport const typeName = Symbol('typeName'),\r\n    isData = Symbol('isData'),\r\n    isSingleton = Symbol('isSingleton');\r\n\r\n/**\r\n * Data types with named parameters and immutable objects.\r\n * @param {Object} variants\r\n * @returns {Object}\r\n * @example\r\n * const Color = Data({ Red: [], Green: [], Blue: [] }),\r\n *       red = Color.Red;\r\n *\r\n * const Point = Data({ Point2: ['x', 'y'], Point3: ['x', 'y', 'z'] }),\r\n *       p2 = Point.Point2({ x: 1, y: 2 }),\r\n *       p3 = Point.Point3({ x: 1, y: 2, z: 3 });\r\n *\r\n * const List = Data({ Nil: [], Cons: ['head', 'tail'] }),\r\n *       list = List.Cons({ head: 1, tail: List.Cons({ head: 2, tail: List.Nil }) });\r\n\r\n * const Peano = Data({ Zero: [], Succ: ['pred'] }),\r\n *       zero = Peano.Zero,\r\n *       succ = Peano.Succ({ pred: Peano.Zero });\r\n * \r\n * const ExtendedColor = Data(Color, { Yellow: [], Magenta: [], Cyan: [] }),\r\n *      red = ExtendedColor.Red,\r\n *      yellow = ExtendedColor.Yellow;\r\n */\r\nexport function Data(Base, variants) {\r\n    let data\r\n    if (Base && variants) {\r\n        if (!Base[isData])\r\n            throw new TypeError('Base must be a Data type');\r\n        data = Object.assign({}, Base, def(variants));\r\n    }\r\n    else if (Base && !variants) {\r\n        data = def(Base);\r\n    }\r\n    else {\r\n        throw new TypeError('Data requires at least one argument');\r\n    }\r\n\r\n    return Object.freeze(data);\r\n}\r\n\r\n","import { typeName } from './Data.mjs';\r\n\r\nexport const isTrait = Symbol('isTrait'),\r\n    all = Symbol('all'),\r\n    apply = Symbol('apply');\r\n\r\nconst protoTrait = () => { }\r\nprotoTrait[isTrait] = true;\r\nprotoTrait[apply] = function (instance, ...args) {\r\n    const name = instance[typeName],\r\n        fn = this[name] ?? this[all];\r\n    if (!fn)\r\n        throw new TypeError(`no trait defined for ${name}`)\r\n    return fn.call(this, instance, ...args)\r\n}\r\n\r\n/**\r\n * Defines a trait for a data declaration.\r\n * const traitFn = Trait(traits)\r\n * const result = traitFn(dataInstance, ...args)\r\n * @overload\r\n * @param {object} traits The traits to define.\r\n * @throws {TypeError} if traits is not an object literal\r\n * @throws {TypeError} if any trait is not a function \r\n * @returns {function} a trait\r\n * @example\r\n * const List = Data({ Nil: [], Cons: ['head', 'tail'] })\r\n * const length = Trait({\r\n *     Nil() { return 0 },\r\n *     Cons({ head, tail }) { return 1 + length(tail) }\r\n * });\r\n * const { Nil, Cons } = List\r\n * // [1, 2, 3]\r\n * const xs = Cons({ head: 1, tail: Cons({ head: 2, tail: Cons({ head: 3, tail: Nil }) }) });\r\n * length(xs) // => 3\r\n *\r\n * @overload\r\n * Defines a trait for a data declaration that extends another trait.\r\n * const traitFn = Trait(baseTrait, traits)\r\n * const result = traitFn(dataInstance, ...args)\r\n * @param {object} baseTrait The trait to extend.\r\n * @param {object} traits The traits to define.\r\n * @throws {TypeError} if baseTrait is not a trait\r\n * @throws {TypeError} if traits is not an object literal\r\n * @throws {TypeError} if any trait is not a function\r\n * @returns {function} a trait\r\n * @example\r\n * const IntExp = Data({ Lit: ['value'], Add: ['left', 'right'] })\r\n * const intPrint = Trait({\r\n *     Lit({ value }) {\r\n *         return value.toString()\r\n *     },\r\n *     Add({ left, right }) {\r\n *         return `(${this[apply](left)} + ${this[apply](right)})`\r\n *     }\r\n * })\r\n * const IntBoolExp = Data(IntExp, { Bool: ['value'], Iff: ['pred', 'ifTrue', 'ifFalse'] })\r\n * const intBoolPrint = Trait(intPrint, {\r\n *     Bool({ value }) { return value.toString() },\r\n *     Iff({ pred, ifTrue, ifFalse }) {\r\n *         return `(${this[apply](pred)} ? ${this[apply](ifTrue)} : ${this[apply](ifFalse)})`\r\n *     }\r\n * });\r\n * // if (true) 1 else 0\r\n * const exp = IntBoolExp.Iff({\r\n *     pred: IntBoolExp.Bool({ value: true }),\r\n *     ifTrue: IntBoolExp.Lit({ value: 1 }),\r\n *     ifFalse: IntBoolExp.Lit({ value: 2 })\r\n * })\r\n */\r\nexport function Trait(...args) {\r\n    const { baseTrait, traits } = args.length === 1 ?\r\n        { traits: args[0] } : { baseTrait: args[0], traits: args[1] }\r\n    let localTraits = (...args) => localTraits[apply](...args)\r\n\r\n    if (baseTrait && traits) {\r\n        if (!baseTrait[isTrait])\r\n            throw new TypeError(`baseTrait must be a Trait: ${baseTrait}`)\r\n        if (typeof traits !== 'object' || Array.isArray(traits))\r\n            throw new TypeError('traits must be an object literal');\r\n        Reflect.setPrototypeOf(localTraits, baseTrait)\r\n    } else if (!baseTrait && traits) {\r\n        if (typeof traits !== 'object' || Array.isArray(traits))\r\n            throw new TypeError('traits must be an object literal');\r\n        Reflect.setPrototypeOf(localTraits, protoTrait)\r\n    } else {\r\n        throw new TypeError('Trait must be called with at least 2 arguments')\r\n    }\r\n    Object.assign(localTraits, traits);\r\n    for (const [name, trait] of Object.entries(localTraits)) {\r\n        if (typeof trait !== 'function')\r\n            throw new TypeError(`trait must be a function: ${name}`);\r\n    }\r\n\r\n    return localTraits\r\n}","import MultiKeyMap from \"@final-hill/multi-key-map\"\r\nimport { Trait, apply } from \"./Trait.mjs\";\r\n\r\nconst visited = Symbol('visited');\r\n/**\r\n * Extends a trait to support the computation of a least fixed point with a bottom element and memoization\r\n * @param {Trait} trait The trait to extend\r\n * @param {any|() => any} bottom The bottom element of the least fixed point\r\n * @returns {Trait} The extended trait\r\n */\r\nexport const memoFix = (trait, bottom) => Trait(trait, {\r\n    [visited]: new MultiKeyMap(),\r\n    [apply](...args) {\r\n        const v = this[visited];\r\n        if (!v.has(...args)) {\r\n            v.set(...args, typeof bottom === 'function' ? bottom(...args) : bottom);\r\n            v.set(...args, trait[apply].apply(this, args));\r\n        }\r\n        return v.get(...args);\r\n    }\r\n})"],"names":["module","exports","t","e","n","r","o","i","l","call","m","c","d","Object","defineProperty","enumerable","get","Symbol","toStringTag","value","__esModule","create","bind","default","prototype","hasOwnProperty","p","s","this","__classPrivateFieldSet","has","TypeError","set","__classPrivateFieldGet","constructor","Map","forEach","WeakMap","iterator","push","clear","delete","length","slice","_forEach","size","toString","map","join","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","definition","key","obj","prop","isObjectLiteral","getPrototypeOf","isCapitalized","str","match","isCamelCase","def","variants","name","params","entries","Array","isArray","every","Set","freeze","assign","typeName","isSingleton","args","objArg","keys","param","arg","seal","isData","Data","Base","data","isTrait","apply","protoTrait","Trait","baseTrait","traits","localTraits","Reflect","setPrototypeOf","trait","instance","fn","visited","memoFix","bottom","v"],"sourceRoot":""}